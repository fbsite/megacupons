<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• (HOJE) Cupons, Lojas e Ofertas REAIS | MegaCupons</title>
    <meta name="description" content="Economize AGORA! Pegue cupons, ofertas de produtos e campanhas 100% gr√°tis para Magazine Luiza, Amazon e mais. Ofertas reais, atualizadas agora.">
    
    <!-- VERIFICA√á√ÉO LOMADEE (ADICIONADA) -->
    <meta name="lomadee" content="2324685" />

    <!-- Metatags SEO e Social -->
    <meta name="keywords" content="cupons de desconto, ofertas, lojas, produtos, campanhas, promo√ß√£o, economizar, magazine luiza, amazon, americanas, frete gr√°tis">
    <meta property="og:title" content="üî• (HOJE) Cupons, Lojas e Ofertas REAIS | MegaCupons">
    <meta property="og:description" content="Economize AGORA! Ofertas reais que expiram em breve.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.megacupons.com.br">
    <meta property="og:image" content="https://placehold.co/1200x630/FF3B80/FFFFFF?text=MegaCupons&font=inter">
    
    <!-- Favicon e Fontes -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- CSS Otimizado -->
    <style>
        :root {
            --color-primary: #FF3B80;
            --color-secondary: #00BFA6;
            --color-warning: #FFA726;
            --color-background: #121212;
            --color-surface: #1E1E1E;
            --color-surface-hover: #2C2C2C;
            --color-text-primary: #FFFFFF;
            --color-text-secondary: #B0B0B0;
            --font-main: 'Inter', sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-main);
            background-color: var(--color-background);
            color: var(--color-text-primary);
            line-height: 1.6;
            padding-bottom: 60px;
        }
        a { text-decoration: none; color: inherit; }
        ul { list-style: none; }

        /* Layout */
        .container { width: 92%; max-width: 1100px; margin: 0 auto; }
        .section { padding: 40px 0; }
        
        /* Header */
        .header { background-color: var(--color-surface); border-bottom: 1px solid #333; padding: 15px 0; position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.6rem; font-weight: 900; color: var(--color-primary); letter-spacing: -1px; display: flex; align-items: center; gap: 8px; }
        .nav-menu { display: flex; gap: 20px; }
        .nav-link { color: var(--color-text-secondary); font-weight: 600; transition: 0.3s; font-size: 0.95rem; }
        .nav-link:hover, .nav-link.active { color: var(--color-text-primary); }

        /* Hero & Busca */
        .hero { text-align: center; padding: 50px 0 30px; background: radial-gradient(circle at center, #1f1f1f 0%, var(--color-background) 100%); }
        .hero h1 { font-size: 2.2rem; font-weight: 900; line-height: 1.2; margin-bottom: 10px; }
        .hero h1 span { color: var(--color-primary); }
        .hero-subtitle { color: var(--color-text-secondary); font-size: 1rem; margin-bottom: 25px; }
        
        .search-container { position: relative; max-width: 500px; margin: 0 auto 30px; }
        .search-box { width: 100%; padding: 15px 20px; padding-right: 50px; border-radius: 30px; border: 2px solid #333; background: var(--color-surface); color: white; font-size: 1rem; outline: none; transition: 0.3s; }
        .search-box:focus { border-color: var(--color-primary); box-shadow: 0 0 15px rgba(255, 59, 128, 0.3); }
        .search-btn { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--color-text-secondary); font-size: 1.2rem; cursor: pointer; }

        /* Timer & Prova Social */
        .countdown-bar { display: flex; justify-content: center; gap: 15px; align-items: center; margin-bottom: 20px; background: rgba(255, 167, 38, 0.1); padding: 10px; border-radius: 8px; border: 1px dashed var(--color-warning); display: inline-flex; }
        .timer-box { display: flex; gap: 5px; font-family: monospace; font-weight: 700; font-size: 1.2rem; color: var(--color-warning); }
        .social-proof { display: flex; justify-content: center; gap: 20px; font-size: 0.85rem; color: var(--color-text-secondary); flex-wrap: wrap; margin-top: 10px; }
        .social-item i { color: var(--color-secondary); margin-right: 5px; }

        /* Categorias / Lojas Destaque */
        .categories-scroll { display: flex; gap: 15px; overflow-x: auto; padding: 10px 0 20px; scrollbar-width: none; }
        .categories-scroll::-webkit-scrollbar { display: none; }
        .cat-item { flex: 0 0 auto; display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; transition: 0.3s; }
        .cat-item:hover { transform: translateY(-5px); }
        .circle-img { width: 65px; height: 65px; border-radius: 50%; background: white; padding: 2px; border: 2px solid var(--color-primary); display: flex; align-items: center; justify-content: center; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .circle-img img { width: 100%; height: 100%; object-fit: contain; border-radius: 50%; padding: 8px; }
        .cat-name { font-size: 0.8rem; font-weight: 600; color: var(--color-text-secondary); }

        /* Grids */
        .section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 25px; }
        .section-title { font-size: 1.4rem; font-weight: 800; }
        .section-icon { color: var(--color-secondary); }
        
        .offers-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        
        /* Card Cupom */
        .coupon-card { background: var(--color-surface); border-radius: 12px; padding: 20px; position: relative; border: 1px solid #333; transition: 0.3s; display: flex; flex-direction: column; }
        .coupon-card:hover { transform: translateY(-5px); border-color: var(--color-primary); box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .badge-exclusive { position: absolute; top: 10px; right: 10px; background: var(--color-warning); color: #000; font-size: 0.7rem; font-weight: 900; padding: 4px 8px; border-radius: 4px; text-transform: uppercase; }
        
        .card-header { display: flex; gap: 15px; align-items: center; margin-bottom: 15px; }
        .card-logo { width: 60px; height: 60px; border-radius: 8px; background: white; object-fit: contain; padding: 5px; border: 1px solid #eee; }
        .card-offer-info h3 { font-size: 1.1rem; font-weight: 800; line-height: 1.2; margin-bottom: 4px; color: var(--color-primary); }
        .card-offer-info p { font-size: 0.85rem; color: var(--color-text-secondary); font-weight: 600; }
        
        .coupon-btn-container { margin-top: auto; background: #2a2a2a; border-radius: 8px; overflow: hidden; display: flex; cursor: pointer; border: 1px dashed #555; transition: 0.2s; position: relative; }
        .coupon-btn-container:hover { border-color: var(--color-primary); }
        .coupon-part-code { background: #333; color: var(--color-text-secondary); padding: 12px; font-family: monospace; font-weight: 700; font-size: 1rem; border-right: 1px dashed #555; display: flex; align-items: center; justify-content: center; width: 40%; }
        .coupon-part-action { background: var(--color-primary); color: white; padding: 12px; flex-grow: 1; font-weight: 800; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; gap: 8px; text-transform: uppercase; }

        /* Card Produto */
        .products-scroll { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: thin; scrollbar-color: var(--color-secondary) var(--color-surface); }
        .product-card { flex: 0 0 200px; background: var(--color-surface); border-radius: 10px; border: 1px solid #333; overflow: hidden; transition: 0.3s; text-decoration: none; color: inherit; }
        .product-card:hover { border-color: var(--color-secondary); }
        .prod-img-box { height: 180px; background: white; position: relative; display: flex; align-items: center; justify-content: center; padding: 10px; }
        .prod-img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .prod-content { padding: 12px; }
        .prod-price { font-size: 1.2rem; font-weight: 900; color: var(--color-secondary); margin: 5px 0; }
        .prod-btn { display: block; text-align: center; background: #333; color: white; padding: 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 700; margin-top: 8px; }

        /* Campanhas */
        .campaign-card { background: var(--color-surface); border-radius: 10px; overflow: hidden; border: 1px solid #333; position: relative; }
        .campaign-img { width: 100%; height: 140px; object-fit: cover; opacity: 0.8; transition: 0.3s; }
        .campaign-card:hover .campaign-img { opacity: 1; transform: scale(1.05); }
        .campaign-title { position: absolute; bottom: 0; left: 0; width: 100%; padding: 10px; background: linear-gradient(to top, black, transparent); font-weight: 700; font-size: 0.9rem; text-shadow: 1px 1px 2px black; }

        /* Footer */
        .footer { border-top: 1px solid #333; margin-top: 50px; padding: 30px 0; text-align: center; color: var(--color-text-secondary); font-size: 0.9rem; }
        
        /* Loader */
        #loader { position: fixed; inset: 0; background: var(--color-background); z-index: 999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .spinner { width: 40px; height: 40px; border: 4px solid #333; border-top-color: var(--color-primary); border-radius: 50%; animation: spin 1s infinite linear; margin-bottom: 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media(min-width: 768px) {
            .hero h1 { font-size: 3rem; }
            .coupon-card { flex-direction: row; align-items: center; }
            .coupon-btn-container { margin-top: 0; width: 200px; margin-left: auto; flex-shrink: 0; }
            .card-header { margin-bottom: 0; width: 50%; }
            .card-meta { display: none; }
        }
    </style>
</head>
<body>

    <div id="loader"><div class="spinner"></div><p>Carregando ofertas...</p></div>

    <header class="header">
        <div class="container header-content">
            <a href="index.html" class="logo"><i class="fa-solid fa-rocket"></i> MegaCupons</a>
            <nav class="nav-menu">
                <a href="index.html" class="nav-link active">In√≠cio</a>
                <a href="stores.html" class="nav-link">Lojas</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="container">
                <h1>Sua Economia Come√ßa <span>AGORA!</span> <i class="fa-solid fa-bolt"></i></h1>
                <p class="hero-subtitle">Cupons verificados e Ofertas Rel√¢mpago.</p>

                <div class="countdown-bar">
                    <span style="color: var(--color-warning); font-weight: 700; text-transform: uppercase;"><i class="fa-solid fa-clock"></i> Ofertas expiram em:</span>
                    <div class="timer-box">
                        <span id="h">23</span>:<span id="m">59</span>:<span id="s">40</span>
                    </div>
                </div>

                <div class="search-container">
                    <input type="text" class="search-box" placeholder="Digite a loja (ex: Amazon)..." id="search-input">
                    <button class="search-btn"><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>

                <div class="categories-scroll" id="destaques-container">
                    <!-- Lojas Destaque via JS -->
                </div>
                
                <div class="social-proof">
                    <div class="social-item"><i class="fa-solid fa-check-circle"></i> 100% Verificado</div>
                    <div class="social-item"><i class="fa-solid fa-user-group"></i> +15k Usu√°rios Hoje</div>
                    <div class="social-item"><i class="fa-solid fa-tag"></i> Gr√°tis</div>
                </div>
            </div>
        </section>
        
        <!-- Espa√ßo Banner Topo -->
        <div class="container" style="margin-bottom: 30px;">
            <div class="ad-space" style="background:var(--color-surface); padding:15px; text-align:center; border-radius:8px; border:1px dashed #444; color:#555; font-size:0.8rem;">
                Publicidade (Leaderboard)
            </div>
        </div>

        <section class="section">
            <div class="container">
                <div class="section-header">
                    <i class="fa-solid fa-fire section-icon"></i>
                    <h2 class="section-title">Campanhas em Alta</h2>
                </div>
                <div class="offers-grid" style="grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));" id="campaigns-container">
                    <!-- Campanhas via API -->
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <div class="section-header">
                    <i class="fa-solid fa-ticket section-icon"></i>
                    <h2 class="section-title">Top Cupons de Hoje</h2>
                </div>
                <div class="offers-grid" style="grid-template-columns: 1fr;" id="coupons-grid">
                    <!-- Cupons via API -->
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <div class="section-header">
                    <i class="fa-solid fa-bag-shopping section-icon"></i>
                    <h2 class="section-title">Ofertas de Produtos</h2>
                </div>
                <div class="products-scroll" id="products-grid">
                    <!-- Produtos via API -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>MegaCupons &copy; <span id="current-year"></span>. Economia real para voc√™.</p>
            <p style="font-size: 0.8rem; margin-top: 10px; opacity: 0.6;">Participamos de programas de afiliados e podemos receber comiss√µes por compras qualificadas.</p>
        </div>
    </footer>
    
    <!-- Script MasterTag Awin -->
    <script src="https://www.dwin2.com/pub.2589771.min.js"></script>

    <script>
        // Configura√ß√£o
        const API_URL = "/api"; 
        const USE_MOCK_DATA = false; // false = Tenta usar API real

        document.addEventListener('DOMContentLoaded', () => {
            startTimer();
            updateYear();
            loadAllData();
            loadDestaques();

            // Busca Instant√¢nea
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const cards = document.querySelectorAll('.coupon-card');
                cards.forEach(card => {
                    const text = card.innerText.toLowerCase();
                    card.style.display = text.includes(term) ? 'flex' : 'none';
                });
            });
        });

        async function loadAllData() {
            try {
                // Tenta carregar APIs em paralelo
                const [couponsRes, campaignsRes, productsRes] = await Promise.all([
                    fetch(`${API_URL}/coupons`),
                    fetch(`${API_URL}/campaigns`),
                    fetch(`${API_URL}/products`)
                ]);

                const coupons = await couponsRes.json();
                const campaigns = await campaignsRes.json();
                const products = await productsRes.json();

                renderCoupons(coupons);
                renderCampaigns(campaigns);
                renderProducts(products);

                document.getElementById('loader').style.display = 'none';

            } catch (error) {
                console.error("Erro ao carregar dados:", error);
                // Se falhar, n√£o deixa tela branca, esconde loader
                document.getElementById('loader').style.display = 'none';
                document.getElementById('coupons-grid').innerHTML = '<p style="text-align:center; padding:20px;">Ofertas indispon√≠veis no momento.</p>';
            }
        }

        function renderCoupons(data) {
            const grid = document.getElementById('coupons-grid');
            grid.innerHTML = '';
            
            // Data validade fake (hoje + 2 dias) para press√£o
            const validDate = new Date();
            validDate.setDate(validDate.getDate() + 2);
            const dateStr = validDate.toLocaleDateString('pt-BR', {day:'2-digit', month:'2-digit'});

            data.forEach(item => {
                const isCode = item.code && item.code !== "null";
                const btnText = isCode ? "VER CUPOM" : "ATIVAR OFERTA";
                const codeDisplay = isCode ? item.code.substring(0, 4) + "***" : "DESCONTO";
                const icon = isCode ? "fa-scissors" : "fa-arrow-right";

                grid.innerHTML += `
                    <article class="coupon-card">
                        ${item.exclusive ? '<div class="badge-exclusive">Exclusivo</div>' : ''}
                        <div class="card-header">
                            <img src="${item.logo}" class="card-logo" alt="${item.store}" onerror="this.src='https://placehold.co/60'">
                            <div class="card-offer-info">
                                <h3>${item.title}</h3>
                                <p>${item.desc}</p>
                                <div class="card-meta" style="font-size:0.75rem; margin-top:5px; opacity:0.7;">
                                    <i class="fa-regular fa-clock"></i> Validade: ${dateStr}
                                </div>
                            </div>
                        </div>
                        
                        <div class="coupon-btn-container" onclick="handleClick('${item.code}', '${item.link}', this)">
                            <div class="coupon-part-code">${codeDisplay}</div>
                            <div class="coupon-part-action">
                                <i class="fa-solid ${icon}"></i> ${btnText}
                            </div>
                        </div>
                    </article>
                `;
            });
        }

        function handleClick(code, link, btn) {
            window.open(link, '_blank');
            if (code && code !== 'null') {
                navigator.clipboard.writeText(code);
                const actionDiv = btn.querySelector('.coupon-part-action');
                const originalText = actionDiv.innerHTML;
                actionDiv.style.background = 'var(--color-secondary)';
                actionDiv.innerHTML = 'COPIADO!';
                setTimeout(() => {
                    actionDiv.style.background = 'var(--color-primary)';
                    actionDiv.innerHTML = originalText;
                }, 3000);
            }
        }

        function renderCampaigns(data) {
            const container = document.getElementById('campaigns-container');
            container.innerHTML = '';
            data.forEach(c => {
                container.innerHTML += `
                    <a href="${c.link || '#'}" target="_blank" class="campaign-card">
                        <img src="${c.img}" class="campaign-img" onerror="this.src='https://placehold.co/280x140?text=Campanha'">
                        <div class="campaign-title">${c.title}</div>
                    </a>
                `;
            });
        }

        function renderProducts(data) {
            const container = document.getElementById('products-grid');
            container.innerHTML = '';
            data.forEach(p => {
                container.innerHTML += `
                    <a href="${p.link || '#'}" target="_blank" class="product-card">
                        <div class="prod-img-box">
                            <img src="${p.img}" class="prod-img" onerror="this.src='https://placehold.co/150'">
                        </div>
                        <div class="prod-content">
                            <div style="font-size:0.7rem; color:#888; margin-bottom:2px;">${p.store || 'Oferta'}</div>
                            <h4 style="font-size:0.9rem; font-weight:600; line-height:1.3; height:2.6em; overflow:hidden;">${p.name}</h4>
                            <div class="prod-price">R$ ${p.price}</div>
                            <span class="prod-btn">Ver na Loja</span>
                        </div>
                    </a>
                `;
            });
        }

        function loadDestaques() {
            const lojas = [
                {name:"Amazon", img:"https://logo.clearbit.com/amazon.com.br"},
                {name:"Magalu", img:"https://logo.clearbit.com/magazineluiza.com.br"},
                {name:"Shopee", img:"https://logo.clearbit.com/shopee.com.br"},
                {name:"AliExpress", img:"https://logo.clearbit.com/aliexpress.com"},
                {name:"Nike", img:"https://logo.clearbit.com/nike.com.br"},
                {name:"Casas Bahia", img:"https://logo.clearbit.com/casasbahia.com.br"},
                {name:"Netshoes", img:"https://logo.clearbit.com/netshoes.com.br"},
                {name:"Samsung", img:"https://logo.clearbit.com/samsung.com"}
            ];
            const container = document.getElementById('destaques-container');
            container.innerHTML = '';
            lojas.forEach(l => {
                container.innerHTML += `
                    <div class="cat-item" onclick="document.getElementById('search-input').value='${l.name}'; document.getElementById('search-input').dispatchEvent(new Event('input'));">
                        <div class="circle-img"><img src="${l.img}" onerror="this.src='https://placehold.co/50'"></div>
                        <span class="cat-name">${l.name}</span>
                    </div>
                `;
            });
        }

        function startTimer() {
            const h = document.getElementById('h'), m = document.getElementById('m'), s = document.getElementById('s');
            if(!h) return;
            setInterval(() => {
                let d = new Date();
                let hours = 23 - d.getHours();
                let mins = 59 - d.getMinutes();
                let secs = 59 - d.getSeconds();
                h.innerText = hours < 10 ? '0'+hours : hours;
                m.innerText = mins < 10 ? '0'+mins : mins;
                s.innerText = secs < 10 ? '0'+secs : secs;
            }, 1000);
        }
        function updateYear(){ document.getElementById('current-year').innerText = new Date().getFullYear(); }
    </script>
</body>
</html>